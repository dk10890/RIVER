<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating glacier lengths in Central Asia • riversCentralAsia</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating glacier lengths in Central Asia">
<meta property="og:description" content="riversCentralAsia">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riversCentralAsia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/estimate-glacier-lengths.html">Estimating glacier lengths in Central Asia</a>
    </li>
    <li>
      <a href="../articles/introduction.html">introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="estimate-glacier-lengths_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating glacier lengths in Central Asia</h1>
            
      
      
      <div class="hidden name"><code>estimate-glacier-lengths.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">riversCentralAsia</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="co">#&gt; Linking to GEOS 3.9.0, GDAL 3.2.1, PROJ 7.2.1</span></code></pre></div>
<div id="background-motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#background-motivation" class="anchor"></a>Background &amp; Motivation</h1>
<p>Melt from glaciers ist the most important contributor of discharge in most of the larger rivers in Central Asia. However, measurements of discharge from glaciers are generally not available. To estimate the contribution from glacier melt to discharge under different climate scenarios, we use empirial relationships published by <span class="citation">Oerlemans (2005)</span> and <span class="citation">Aizen, Aizen, and Kuzmichonok (2007)</span> which are described below.</p>
<div id="glacier-length-model-by-oerlemans" class="section level2">
<h2 class="hasAnchor">
<a href="#glacier-length-model-by-oerlemans" class="anchor"></a>Glacier length model by Oerlemans</h2>
<p><span class="citation">Oerlemans (2005)</span> analysed a global glacier length time series and relate glacier length to temperature as follows:</p>
<p><span class="math display">\[\frac{dL'(t)}{dt}=-\frac{1}{\tau} \cdot \left( c \cdot T'(t) + L'(t) \right)\]</span> where the glacier length of year <span class="math inline">\(t\)</span>, <span class="math inline">\(L(t)\)</span> is defined as the glacier length in the reference year <span class="math inline">\(L_0\)</span> plus the change of the glacier length with respect to the reference year <span class="math inline">\(L'(t)\)</span> (see below). <span class="math inline">\(T'(t)\)</span> is the mean annual temperature perturbance with respect to a baseline mean temperature.</p>
<p><span class="math display">\[L(t) = L_0 + L'(t)\]</span> The response time <span class="math inline">\(\tau\)</span> [a] is parameterised as proposed by <span class="citation">Oerlemans (2005)</span> as</p>
<p><span class="math display">\[\tau = \frac{2266.67}{s \cdot \sqrt{L_0 \cdot (1+20 \cdot s) \cdot P(t)}}\]</span> <span class="math inline">\(s\)</span> is the average glacier slope [-] that is available from <span class="citation">Consortium (2017)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. <span class="math inline">\(P(t)\)</span> is the annual precipitation [m].<br>
The climate sensitivity <span class="math inline">\(c\)</span> [m/<span class="math inline">\(^{\circ}\)</span>C] is given by</p>
<p><span class="math display">\[c=2.3 \cdot \frac{P(t)^{0.6}}{s}\]</span></p>
</div>
<div id="glaciers-volume---length-relationships-by-aizen-et-al-" class="section level2">
<h2 class="hasAnchor">
<a href="#glaciers-volume---length-relationships-by-aizen-et-al-" class="anchor"></a>Glaciers volume - length relationships by Aizen et al. </h2>
<p><span class="citation">Aizen, Aizen, and Kuzmichonok (2007)</span> reports scaling relationships between glacier length and surface area and between glacier surface area and volume in the Tien Shan mountains. They are:</p>
<p><span class="math display">\[S=\left(\frac{L}{1.6724}\right)^{\frac{1}{0.561}}\]</span></p>
<p><span class="math display">\[V=0.03782 \cdot S^{1.23}\text{ }\text{ }\text{ for }\text{ }\text{ } S&lt;0.1\text{ km}^2\]</span></p>
<p><span class="math display">\[V=\frac{\left(0.03332 \cdot S^{1.08} \cdot e^{0.1219 \cdot L}\right)}{L^{0.08846}}\text{ }\text{ }\text{ for }\text{ }\text{ } 0.1 &lt; S &lt; 25\text{ km}^2\]</span></p>
<p><span class="math display">\[V=0.018484 \cdot S + 0.021875 \cdot S^{1.3521}\text{ }\text{ }\text{ for }\text{ }\text{ } S &gt; 25\text{ km}^2\]</span></p>
<p>with the glacier surface area <span class="math inline">\(S\)</span> in [km<span class="math inline">\(^2\)</span>] and the glacier volume <span class="math inline">\(V\)</span> [km<span class="math inline">\(^3\)</span>].</p>
<p>The method was applied in <span class="citation">Siegfried et al. (2012)</span> with the following extensions. They found that the glacier area reported in the GLIMS data set corresponds well to the data reported in Aizen (2007).</p>
<p>Note that the relationships above have been derived from annual glacier length data.</p>
</div>
</div>
<div id="how-to-estimate-glacier-lengths-for-climate-scenarios" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-estimate-glacier-lengths-for-climate-scenarios" class="anchor"></a>How to estimate glacier lengths for climate scenarios</h1>
<div id="load-example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-example-data" class="anchor"></a>Load example data</h2>
<p>The example data set for this vignette contains an subset of the Randolph Glacier Inventory 6.0 <span class="citation">(Consortium 2017)</span> and average temperatures and precipitation for each glacier between 2006 and 2100. The climate prediction data has been downloaded from <span class="citation">Karger et al. (2020)</span> and bias correction following <span class="citation">Beck et al. (2020)</span> is applied. A more detailed description of how this was done is given in the course book <a href="https://tobiassiegfried.github.io/HydrologicalModeling_CentralAsia/data-on-climate-projections.html">Applied Modeling of Hydrological Systems in Central Asia</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"vignette_estimate_glacier_lengths"</span><span class="op">)</span>
<span class="co"># Subset of the Randolph Glacier Inventory 6.0</span>
<span class="va">rgi6</span> <span class="op">&lt;-</span> <span class="va">vignette_estimate_glacier_lengths</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co"># Precipitation data per glacier, over time for 3 climate prediction models and 2 RCP scenarios. </span>
<span class="va">prec</span> <span class="op">&lt;-</span> <span class="va">vignette_estimate_glacier_lengths</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="co"># Temperature data per glacier, over time for 3 climate prediction models and 2 RCP scenarios. </span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">vignette_estimate_glacier_lengths</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">vignette_estimate_glacier_lengths</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">rgi6</span><span class="op">[</span><span class="st">"Lmax"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-rgi6-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`P [m/a]`</span>, group <span class="op">=</span> <span class="va">Glacier</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`P [m/a]`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, 
              weight <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RCP"</span>, <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-precipitation-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`T [deg C]`</span>, group <span class="op">=</span> <span class="va">Glacier</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`T [deg C]`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, 
              weight <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RCP"</span>, <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-temperature-1.png" width="700"></p>
</div>
<div id="calculate-temperature-annomaly" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-temperature-annomaly" class="anchor"></a>Calculate temperature annomaly</h2>
<p>Oerlemans function use temperature deviations from the baseline period as model forcing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># 10 years of baseline, i.e. 2006 - 2016</span>
<span class="va">yearbase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span> <span class="op">+</span> <span class="va">baseline</span>
<span class="va">tbaseline</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&lt;=</span> <span class="va">yearbase</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">RCP</span>, <span class="va">Glacier</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>`T [deg C]` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`T [deg C]`</span><span class="op">)</span><span class="op">)</span>
<span class="va">tannomaly</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tbaseline</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model"</span>, <span class="st">"RCP"</span>, <span class="st">"Glacier"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`Ta [deg K]` <span class="op">=</span> <span class="va">`T [deg C].x`</span> <span class="op">-</span> <span class="va">`T [deg C].y`</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">`T [deg C].x`</span>, <span class="op">-</span><span class="va">`T [deg C].y`</span><span class="op">)</span></code></pre></div>
</div>
<div id="calculate-glacier-length" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-glacier-length" class="anchor"></a>Calculate glacier length</h2>
<p>This may take a while.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu">riversCentralAsia</span><span class="fu">::</span><span class="fu"><a href="../reference/OerlemansGlacierLengthModel_FormatLong.html">OerlemansGlacierLengthModel_FormatLong</a></span><span class="op">(</span><span class="va">tannomaly</span>, <span class="va">prec</span>, <span class="fl">10</span>, <span class="va">rgi6</span><span class="op">)</span>
<span class="va">dL</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">L</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dL</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`dL(t) [km]`</span>, group <span class="op">=</span> <span class="va">Glacier</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`dL(t) [km]`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, 
              weight <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RCP"</span>, <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-length-change-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">L</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`L(t) [km]`</span>, group <span class="op">=</span> <span class="va">Glacier</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">`L(t) [km]`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, 
              weight <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RCP"</span>, <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-length-1.png" width="700"></p>
</div>
<div id="calculate-glacier-volume" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-glacier-volume" class="anchor"></a>Calculate glacier volume</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glacier_volumes</span> <span class="op">&lt;-</span> <span class="fu">riversCentralAsia</span><span class="fu">::</span><span class="fu"><a href="../reference/AizensGlacierFunctions.html">AizensGlacierFunctions</a></span><span class="op">(</span><span class="op">(</span><span class="va">L</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">L</span><span class="op">$</span><span class="va">`L(t) [km]`</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="volume-change" class="section level2">
<h2 class="hasAnchor">
<a href="#volume-change" class="anchor"></a>Volume change</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glacier_volumes</span> <span class="op">&lt;-</span> <span class="va">glacier_volumes</span> <span class="op">%&gt;%</span>
 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Glacier</span>, <span class="va">RCP</span>, <span class="va">Model</span><span class="op">)</span><span class="op">%&gt;%</span>
 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>VolumeChange_km3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">Volume_Aizen_km3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Filter out the largest glacier and sum up the negative volume change.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glacier_volumes_min</span> <span class="op">&lt;-</span> <span class="va">glacier_volumes</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Glacier</span> <span class="op">!=</span> <span class="st">"V314"</span><span class="op">)</span>

<span class="va">total_glacier_melt</span> <span class="op">&lt;-</span> <span class="va">glacier_volumes</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">RCP</span>, <span class="va">Model</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>NegChange_km2 <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">VolumeChange_km3</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="va">VolumeChange_km3</span>, <span class="fl">0</span><span class="op">)</span>, 
         PosChange_km2 <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">VolumeChange_km3</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="va">VolumeChange_km3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>av_Length_km <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`L(t) [km]`</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
            av_Area_km2 <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Area_Aizen_km2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
            av_NegVolChange_km3 <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">NegChange_km2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>, 
            av_PosVolChange_km3 <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PosChange_km2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">total_glacier_melt</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">av_NegVolChange_km3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">av_NegVolChange_km3</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RCP"</span>, <span class="st">"Model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="estimate-glacier-lengths_files/figure-html/plot-glacier-volume-1.png" width="700"></p>
<p>Note that these empirical relationships are not suitable for applications on individual glaciers.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aizen_glaciers_2007" class="csl-entry">
Aizen, V B, E M Aizen, and V A Kuzmichonok. 2007. <span>“Glaciers and Hydrological Changes in the <span>Tien</span> <span>Shan</span>: Simulation and Prediction.”</span> <em>Environmental Research Letters</em> 2 (4): 045019. <a href="https://doi.org/10.1088/1748-9326/2/4/045019">https://doi.org/10.1088/1748-9326/2/4/045019</a>.
</div>
<div id="ref-beck_bias_2020" class="csl-entry">
Beck, Hylke E., Eric F. Wood, Tim R. McVicar, Mauricio Zambrano-Bigiarini, Camila Alvarez-Garreton, Oscar M. Baez-Villanueva, Justin Sheffield, and Dirk N. Karger. 2020. <span>“Bias <span>Correction</span> of <span>Global</span> <span>High</span>-<span>Resolution</span> <span>Precipitation</span> <span>Climatologies</span> <span>Using</span> <span>Streamflow</span> <span>Observations</span> from 9372 <span>Catchments</span>.”</span> <em>Journal of Climate</em> 33 (4): 1299–1315. <a href="https://doi.org/10.1175/JCLI-D-19-0332.1">https://doi.org/10.1175/JCLI-D-19-0332.1</a>.
</div>
<div id="ref-rgi_consortium_randolph_2017" class="csl-entry">
Consortium, RGI. 2017. <span>“Randolph <span>Glacier</span> <span>Inventory</span> – <span>A</span> <span>Dataset</span> of <span>Global</span> <span>Glacier</span> <span>Outlines</span>: <span>Version</span> 6.0.”</span> https://doi.org/<a href="https://doi.org/10.7265/N5-RGI-60">https://doi.org/10.7265/N5-RGI-60</a>.
</div>
<div id="ref-karger_high-resolution_2020" class="csl-entry">
Karger, Dirk Nikolaus, Dirk R. Schmatz, Gabriel Dettling, and Niklaus E. Zimmermann. 2020. <span>“High-Resolution Monthly Precipitation and Temperature Time Series from 2006 to 2100.”</span> <em>Scientific Data</em> 7 (1): 248. <a href="https://doi.org/10.1038/s41597-020-00587-y">https://doi.org/10.1038/s41597-020-00587-y</a>.
</div>
<div id="ref-oerlemans_extracting_2005" class="csl-entry">
Oerlemans, J. 2005. <span>“Extracting a <span>Climate</span> <span>Signal</span> from 169 <span>Glacier</span> <span>Records</span>.”</span> <em>Science</em> 308 (5722): 675–77. <a href="https://doi.org/10.1126/science.1107046">https://doi.org/10.1126/science.1107046</a>.
</div>
<div id="ref-siegfried_will_2012" class="csl-entry">
Siegfried, Tobias, Thomas Bernauer, Renaud Guiennet, Scott Sellars, Andrew W Robertson, Justin Mankin, Peter Bauer-Gottwein, and Andrey Yakovlev. 2012. <span>“Will <span>Climate</span> <span>Change</span> <span>Exacerbate</span> <span>Water</span> <span>Stress</span> in <span>Central</span> <span>Asia</span>?”</span> <em>Climate Change</em> 112: 881–99. <a href="https://doi.org/DOI%2010.1007/s10584-011-0253-z">https://doi.org/DOI 10.1007/s10584-011-0253-z</a>.
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The RGI6 dataset is roughly compatible with the GLIMS data set in the Sokh river catchment but much easier to handle.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
