<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Glaciers 04 - Glacier discharge in RS Minerve • riversCentralAsia</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Glaciers 04 - Glacier discharge in RS Minerve">
<meta property="og:description" content="riversCentralAsia">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riversCentralAsia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00-introduction.html">Introduction to the package</a>
    </li>
    <li>
      <a href="../articles/glaciers-01-intro.html">Glaciers 01 - Intro</a>
    </li>
    <li>
      <a href="../articles/glaciers-02-DDMWB.html">Glaciers 02 - Temperature index model</a>
    </li>
    <li>
      <a href="../articles/glaciers-03-oerlemans.html">Glaciers 03 - Estimating glacier lengths in Central Asia</a>
    </li>
    <li>
      <a href="../articles/glaciers-04-glaciers-RSM.html">Glaciers 04 - Glacier discharge in RS Minerve</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hydrosolutions/riversCentralAsia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="glaciers-04-glaciers-RSM_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Glaciers 04 - Glacier discharge in RS
Minerve</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hydrosolutions/riversCentralAsia/blob/master/vignettes/glaciers-04-glaciers-RSM.rmd"><code>vignettes/glaciers-04-glaciers-RSM.rmd</code></a></small>
      <div class="hidden name"><code>glaciers-04-glaciers-RSM.rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hydrosolutions.github.io/riversCentralAsia/index.html">riversCentralAsia</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></code></pre></div>
<div id="glacier-modelling-tools-in-rs-minerve" class="section level1">
<h1 class="hasAnchor">
<a href="#glacier-modelling-tools-in-rs-minerve" class="anchor"></a>Glacier modelling tools in RS Minerve</h1>
<p>At the time of writing (Feb 2022), RS Minerve features one model to
simulate glacier discharge, the GSM model <span class="citation">(Garcia
Hernandez et al. 2020)</span>. The GSM model is able to accumulate solid
precipitation on a glacier water reservoir and to melt that reservoir
depending on temperature. It is a suitable temperature index model for
short-term glacier melt where changes in glacier area can be
neglected.</p>
<div class="figure">
<img src="../../../../../Dropbox%20(hydrosolutions)/marti/github/riversCentralAsia/vignettes/RSM_GSM.png" style="width:60.0%" alt=""><p class="caption">Flow path of the GSM model in RS Minerve. Image
source: RSMinerve Technical Manual.</p>
</div>
<p>As implied above, the GSM model in RSM assumes a constant glacier
area. It is thus not suitable for long-term simulations of glacier melt,
especially under climate change scenarios where glacier area changes are
important. In other words, the GSM model cannot predict when a glacier
reservoir has disappeared.</p>
<p>In practice, two pathways are possible to handle the weakness of the
model when simulating climate change impacts:</p>
<ul>
<li><p>The modeler periodically stops the simulation and checks which
glaciers have disappeared, then manually adapts the model
parameters.</p></li>
<li><p>The glacier melt is simulated outside RS Minerve and subsequently
introduced to RS Minerve as a water source.</p></li>
</ul>
<p>The first approach is suitable for one-time simulations but it is
labor intensive and thus hardly scalable. It further does not solve the
problem that the glacier area remains constant in the model. The latter
approach requires the separation of seasonal glacier discharge under
balance conditions (i.e. the seasonal glacier melt which is compensated
by accumulation of snow in winter) and the imbalance ablation which
represent glacier melt due to rising temperatures.</p>
<p>Here, we present the second approach. <a href="glaciers-02-DDMWB.html">Vignette 2 on the glacier mass balance
modelling</a> demonstrates how to calculate total annual glacier
discharge and the contribution of imbalance ablation to the total annual
glacier discharge. This vignette demonstrates how to derive daily
glacier discharge and imbalance ablation time series from the annual
data and how to include this data in RS Minerve.</p>
</div>
<div id="from-annual-to-daily-melt" class="section level1">
<h1 class="hasAnchor">
<a href="#from-annual-to-daily-melt" class="anchor"></a>From annual to daily melt</h1>
<p>The glacier mass balance is done on a yearly basis (if not at lower
frequency). Hydrological models, however, typically run at higher
frequency, for example monthly or daily time steps. One simple method to
distribute glacier discharge on a year is to scale it according to the
daily melt computed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Glacier discharge from imbalance ablation. " </span>
<span class="co">#| out.width = 90%</span>
<span class="co"># Read in the daily glacier melt and the annual glacier discharge and imbalance </span>
<span class="co"># ablation computed in glacier vignette 2. </span>
<span class="va">melt_mmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"daily_glacier_melt.rds"</span><span class="op">)</span>
<span class="va">glacier_balance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"glacier_balance.rds"</span><span class="op">)</span>

<span class="co"># Compute the annual glacier melt</span>
<span class="va">melt_mma</span> <span class="op">&lt;-</span> <span class="va">melt_mmd</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>Hyear <span class="op">=</span> <span class="fu"><a href="../reference/hyear.html">hyear</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Hyear</span>, <span class="va">RGIId</span><span class="op">)</span> |&gt; 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>M_mma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">M_mmd</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span>

<span class="va">imbalAbl_m3s</span> <span class="op">&lt;-</span> <span class="va">melt_mmd</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>Hyear <span class="op">=</span> <span class="fu"><a href="../reference/hyear.html">hyear</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu">left_join</span><span class="op">(</span><span class="va">melt_mma</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RGIId"</span>, <span class="st">"Hyear"</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu">left_join</span><span class="op">(</span><span class="va">glacier_balance</span> |&gt; 
              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Variable</span> <span class="op">==</span> <span class="st">"Qimb_m3a"</span><span class="op">)</span> |&gt; 
              <span class="fu">transmute</span><span class="op">(</span>Hyear <span class="op">=</span> <span class="va">Hyear</span>, 
                        RGIId <span class="op">=</span> <span class="va">RGIId</span>, 
                        Qimba_m3s <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span> <span class="va">Value</span><span class="op">/</span><span class="op">(</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">24</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span> |&gt; 
              <span class="fu">mutate</span><span class="op">(</span>Qimba_m3s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Qimba_m3s</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">Qimba_m3s</span><span class="op">)</span><span class="op">)</span>, 
            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RGIId"</span>, <span class="st">"Hyear"</span><span class="op">)</span><span class="op">)</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>Qimb_m3s <span class="op">=</span> <span class="va">Qimba_m3s</span> <span class="op">*</span> <span class="op">(</span><span class="va">M_mmd</span><span class="op">/</span><span class="va">M_mma</span><span class="op">)</span>, 
         Qimb_m3s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Qimb_m3s</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">Qimb_m3s</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">imbalAbl_m3s</span> |&gt; 
         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">RGIId</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/unique.html">unique</a></span><span class="op">(</span><span class="va">glacier_balance</span><span class="op">$</span><span class="va">RGIId</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">Qimb_m3s</span>, colour <span class="op">=</span> <span class="va">RGIId</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Glacier discharge from imbalance ablation [m3/s]"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-04-glaciers-RSM_files/figure-html/imbalabl-1.png" width="700"></p>
</div>
<div id="aggregation-to-sub-basins" class="section level1">
<h1 class="hasAnchor">
<a href="#aggregation-to-sub-basins" class="anchor"></a>Aggregation to sub-basins</h1>
<p>You don’t need to implement a source for each glacier in RS Minerve.
You can aggregate the imbalance ablation by sub-basins and save you some
work implementing the sources in RS Minerve. What you will need is a
shape file telling you in which sub-basin each glacier lies. This GIS
layer needs to be prepared manually in QGIS because typically, the RGI
v6.0 glacier outlines are not consistent with the river basin boundaries
derived from SRTM. In QGIS you intersect the sub-basin layer with the
RGI layer and manually adapt the boundaries between the sub-basins to be
consistent with the glacier outlines. This step is important as you will
double count any glaciers which are cut by sub-basin boundaries and thus
are present in two different sub-basins.</p>
<p>We have prepared this for you and already intersected the sub-basin
boundary object with the glacier outlines.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Glaciers coloured by sub-basin." </span>
<span class="co">#| out.width = 90%</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">vignette_glacier_melt</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">rgi</span> |&gt; <span class="fu">mutate</span><span class="op">(</span><span class="st">"Sub-basin"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_Subbasin"</span>, <span class="st">""</span>, <span class="va">name_2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">basin</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">`Sub-basin`</span>, colour <span class="op">=</span> <span class="va">`Sub-basin`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-04-glaciers-RSM_files/figure-html/glaciersbysubbasin-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Glacier discharge from imbalance ablation aggregated to sub-basins. " </span>
<span class="co">#| out.width = 90%</span>
<span class="va">Qimb_m3s_sub</span> <span class="op">&lt;-</span> <span class="va">imbalAbl_m3s</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">RGIId</span>, <span class="va">date</span>, <span class="va">Qimb_m3s</span><span class="op">)</span> |&gt;
  <span class="fu">left_join</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">rgi</span> |&gt; 
              <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> |&gt;
              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">RGIId</span>, <span class="va">name_2</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">group_by</span><span class="op">(</span><span class="va">date</span>, <span class="va">name_2</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>Qimb_m3s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Qimb_m3s</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> 

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Qimb_m3s_sub</span> |&gt; 
         <span class="fu">mutate</span><span class="op">(</span><span class="st">"Sub-basin"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_Subbasin"</span>, <span class="st">""</span>, <span class="va">name_2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">Qimb_m3s</span>, colour <span class="op">=</span> <span class="va">`Sub-basin`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Glacier discharge from imbalance ablation [m3/s]"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-04-glaciers-RSM_files/figure-html/imbalAblSubbasin-1.png" width="700"></p>
</div>
<div id="writing-input-file-for-rs-minerve" class="section level1">
<h1 class="hasAnchor">
<a href="#writing-input-file-for-rs-minerve" class="anchor"></a>Writing input file for RS Minerve</h1>
<p>The input file format for RS Minerve is described in <span class="citation">Garcia Hernandez et al. (2020)</span>, page 136.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">Qimb_m3s_sub</span> |&gt;
  <span class="fu">mutate</span><span class="op">(</span>Qimb_m3s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Qimb_m3s</span>, digits <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="va">temp_wide</span> <span class="op">&lt;-</span> <span class="va">Q</span> |&gt;
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">name_2</span>, values_from <span class="op">=</span> <span class="va">Qimb_m3s</span><span class="op">)</span> |&gt; 
  <span class="fu">rename</span><span class="op">(</span>Station <span class="op">=</span> <span class="va">date</span><span class="op">)</span> 

<span class="va">datechar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posixct2rsminerveChar.html">posixct2rsminerveChar</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">$</span><span class="va">Station</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>
<span class="va">datechar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" 01:00:00"</span>, <span class="st">" 00:00:00"</span>, <span class="va">datechar</span><span class="op">)</span>
<span class="va">datechar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" 02:00:00"</span>, <span class="st">" 00:00:00"</span>, <span class="va">datechar</span><span class="op">)</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">)</span>,
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"1"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span>, <span class="st">"3"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sensor"</span>, <span class="st">"Q"</span>, <span class="st">"Q"</span>, <span class="st">"Q"</span>, <span class="st">"Q"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Category"</span>, <span class="st">"Flow"</span>, <span class="st">"Flow"</span>, <span class="st">"Flow"</span>, <span class="st">"Flow"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Unit"</span>, <span class="st">"m3/s"</span>, <span class="st">"m3/s"</span>, <span class="st">"m3/s"</span>, <span class="st">"m3/s"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Interpolation"</span>, <span class="st">"Linear"</span>, <span class="st">"Linear"</span>, <span class="st">"Linear"</span>, 
                  <span class="st">"Linear"</span><span class="op">)</span>, 
                <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">datechar</span>, 
                      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.character.html">as.character</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">$</span><span class="va">Dzhaldzhur_Subbasin</span><span class="op">)</span>, 
                      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.character.html">as.character</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">$</span><span class="va">Ulak_Subbasin</span><span class="op">)</span>, 
                      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.character.html">as.character</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">$</span><span class="va">Atbaschy_Midstream_Subbasin</span><span class="op">)</span>, 
                      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.character.html">as.character</a></span><span class="op">(</span><span class="va">temp_wide</span><span class="op">$</span><span class="va">Atbaschy_Downstream_Subbasin</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">writefilename</span> <span class="op">&lt;-</span> <span class="st">"~/../Documents/RSM_demo_glacier_source.csv"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">output</span>, file <span class="op">=</span> <span class="va">writefilename</span>, col.names <span class="op">=</span> <span class="cn">FALSE</span>, 
            row.names <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">FALSE</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, 
            sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-rsminerve_tm" class="csl-entry">
Garcia Hernandez, J., A. Foehn, J. Fluixa-Sanmartin, B. Roquier, T.
Brauchli, J. Paredes Arquiola, and De Cesare G. 2020. <span>“RS MINERVE
- Technical Manual, V2.25.”</span> ISSN 2673-2661. Switzerland: Ed.
CREALP.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tobias Siegfried, Beatrice Marti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
