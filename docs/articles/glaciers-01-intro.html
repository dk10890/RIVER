<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Glaciers 01 - Intro • riversCentralAsia</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Glaciers 01 - Intro">
<meta property="og:description" content="riversCentralAsia">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">riversCentralAsia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00-introduction.html">Introduction to the package</a>
    </li>
    <li>
      <a href="../articles/glaciers-01-intro.html">Glaciers 01 - Intro</a>
    </li>
    <li>
      <a href="../articles/glaciers-02-DDMWB.html">Glaciers 02 - Temperature index model</a>
    </li>
    <li>
      <a href="../articles/glaciers-03-oerlemans.html">Glaciers 03 - Estimating glacier lengths in Central Asia</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hydrosolutions/riversCentralAsia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="glaciers-01-intro_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Glaciers 01 - Intro</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hydrosolutions/riversCentralAsia/blob/master/vignettes/glaciers-01-intro.Rmd"><code>vignettes/glaciers-01-intro.Rmd</code></a></small>
      <div class="hidden name"><code>glaciers-01-intro.Rmd</code></div>

    </div>

    
    
<div id="background-motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#background-motivation" class="anchor"></a>Background &amp; Motivation</h1>
<p>Melt from glaciers is the most important contributor of discharge in
most of the larger rivers in Central Asia. However, measurements of
discharge from glaciers are generally not available. There are several
possible ways to estimate glacier contribution to discharge. We present
a short introduction to glaciers in water resources and a workflow for
an empirical method and one via a temperature index model and a simple
glacier mass balance.</p>
</div>
<div id="glaciers-in-water-resources-modelling" class="section level1">
<h1 class="hasAnchor">
<a href="#glaciers-in-water-resources-modelling" class="anchor"></a>Glaciers in water resources modelling</h1>
<p>Glaciers consist of compacted snow. Many processes contribute to the
glacier mass balance but we focus on a simplified mass balance as we
have data only for accumulated mass balance outcomes (i.e. glacier
thinning rates and glacier discharge, see below).</p>
<p>Glaciers accumulate mass in the cold period and at higher altitudes
through snow fall. Glaciers loose mass to melt caused by radiation.
Typically, larger glaciers loose mass at lower altitudes (ablation zone)
and accumulate mass at higher altitudes (accumulation zone). The mass
loss in the lower altitudes is compensated by the downstream movement of
ice from the accumulation zone. The boundary between the accumulation
and the ablation zone is called the equilibrium line altitude (ELA).</p>
<p>Naturally, glaciers accumulate mass in the cold season and loose mass
to ablation in the warm season. Therefore, overall mass balance of a
glacier thus should be calculated over a year or, better, over the
average of several years.</p>
<p>A simplified multi-year-average glacier mass balance can be expressed
as:</p>
<p><span class="math display">\[
\Delta S = P - M
\]</span></p>
<p>where <span class="math inline">\(\Delta S\)</span> is the change of
water storage in the glacier, <span class="math inline">\(P\)</span> is
the precipitation over the glacier (assumed to be solid precipitation)
and <span class="math inline">\(M\)</span> is the glacier melt. If <span class="math inline">\(\Delta S\)</span> is larger than 0 (<span class="math inline">\(P&gt;M\)</span>), the glacier accumulates solid
water and is growing. If <span class="math inline">\(\Delta S\)</span>
is smaller than 0 (<span class="math inline">\(P&lt;M\)</span>), we have
imbalance ablation and the glacier shrinks. Glacier melt <span class="math inline">\(M\)</span> can be modeled using full energy
balance models or simplifications thereof, e.g. temperature index
models. We’ll introduce a temperature index model in (this glaciers
vignette)<span class="math display">\[glaciers-02-DDMWB.html\]</span>.</p>
<p>If the glaciers on average accumulates as much snow as it looses to
melt, it is in balance. The average annual glacier discharge is
equivalent to the average annual snow fall and called balance ablation.
The ELA does not move. If the glacier produces more discharge than it
accumulates from snow fall, it is not in balance. The ELA moves upwards.
The excess melt is called imbalance ablation. If more snow falls that
melts, the ELA moves downstream and the glacier grows.</p>
<div class="figure">
<img src="OGGM_glacier.gif" style="width:90.0%" alt=""><p class="caption">Glacier graphics by Anne Maussion, Atelier les Gros
yeux, for Open Global Glacier Model (OGGM).</p>
</div>
<p>Most glaciers worldwide are currently not in equilibrium with the
warmer than long-term average climate and thus produce excess melt. In
the short term, this is good for agriculture as more water is
temporarily available for irrigation. However, the glaciers produce
excess melt only until they reach a new equilibrium at higher altitudes
or until they disappear. This means that the excess melt will also
disappear and ultimately less water will be available for downstream
users. This phenomenon is called peak water <span class="citation">(Huss
and Hock 2018)</span>.</p>
<div class="figure">
<img src="HussHockPeakWater.png" style="width:90.0%" alt=""><p class="caption">An illustration of peak water by <span class="citation">Huss and Hock (2018)</span></p>
</div>
<p>Water resources managers in glaciated catchments are highly
interested in knowing when peak water will be reached as measures to
adapt for lower water availability need time to implement.</p>
<p>Without in-situ measurements (and actually even with in-situ
measurements) it is no easy feat to model the evolution of the water
storage in a glacier. The best we can do in water resources modelling
is: Use results from existing glacier models and feed them to the water
resources model or use the best data available to estimate glacier melt
with simple models.</p>
<p>The following vignettes show:</p>
<ul>
<li><p>An overview over the available glacier-related data (status early
2022)</p></li>
<li><p>A method to estimate glacier discharge for a catchment based on a
temperature driven degree-day melt function and a simplified glacier
mass balance.</p></li>
</ul>
<p>The data and methods are illustrated in a sample catchment.</p>
</div>
<div id="availability-on-glacier-related-data" class="section level1">
<h1 class="hasAnchor">
<a href="#availability-on-glacier-related-data" class="anchor"></a>Availability on glacier-related data</h1>
<p>Recent advances in glacier research yielded a stupendous amount of
novel data sets that can be used to map glaciers and to force glacier
melt models. The following section gives an overview over the data used
in the models, status January 2022.</p>
<p>Note: For speed’s sake we use a demo data set of the catchment of
Atbashy river in the Naryn catchment in Kyrgyzstan. The data is loaded
as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"vignette_glacier_melt"</span><span class="op">)</span>

<span class="co"># Also load the digital elevation model (DEM) of the catchment for </span>
<span class="co"># visualization.</span>
<span class="va">dem_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">as</span><span class="op">(</span><span class="va">dem</span>, <span class="st">"SpatialPixelsDataFrame"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dem_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Elevation\n[masl]"</span>, <span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></code></pre></div>
<div id="randolph-glacier-inventory" class="section level2">
<h2 class="hasAnchor">
<a href="#randolph-glacier-inventory" class="anchor"></a>Randolph glacier inventory</h2>
<p>The Randolph glacier inventory (RGI) v6.0 <span class="citation">(RGI
Consortium 2017)</span> makes a consistent glacier data base publicly
available. It includes geo-located glacier geometry and some additional
parameters like elevation, length, slope and aspect. A new version (v7)
is under review at the time of writing. For Central Asian water
resources modelling, RGI regions 13 (Central Asia) and 14 (South Asia
West) are relevant. You can download the data from <a href="https://www.glims.org/RGI/rgi60_dl.html">the GLIMS RGI v6.0 web
site</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "DEM &amp; Glaciers of the demo basin." </span>
<span class="co">#| out.width = 90%</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">rgi</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_raster</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dem_df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">`Elevation\n[masl]`</span><span class="op">)</span>, 
              alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightgray"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_gradientn</span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Longitude"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-01-intro_files/figure-html/rgi-1.png" width="700"></p>
</div>
<div id="glacier-thickness" class="section level2">
<h2 class="hasAnchor">
<a href="#glacier-thickness" class="anchor"></a>Glacier thickness</h2>
<p><span class="citation">Farinotti et al. (2019)</span> make
distributed glacier thickness maps available for each glacier in the RGI
v6 data set. We have generated a mosaic of the glacier thickness tifs
for you. We will refer to this data set as the glacier thickness data
set or the Farinotti data set.</p>
<p>If you are interested to replicate the download and pre-processing
please read the section below. The glacier thickness data set is
available from the <a href="https://www.research-collection.ethz.ch/handle/20.500.11850/315707">data
collection</a> of <span class="citation">Farinotti et al. (2019)</span>
which is available from <a href="https://www.nature.com/articles/s41561-019-0300-3">the data
section of their online article</a>. You can download the glacier
thickness composites for the relevant RGI v6.0 regions 13 and 14. In the
unzipped directories you will find individual tif files for each
glacier. The following section demonstrates how to extract glacier
thickness data from the Farinotti data set.</p>
<div id="how-to-extract-glacier-thickness" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-extract-glacier-thickness" class="anchor"></a>How to extract glacier thickness</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get a list of all files in the glacier thickness data set. The files are named </span>
<span class="co"># after the glacier ID in the RGI v6.0 data set (variable RGIId).  </span>
<span class="va">glacier_thickness_dir</span> <span class="op">&lt;-</span> <span class="st">"&lt;Path to glacier thickness tif files (unzipped)&gt;"</span> 

<span class="va">filelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">glacier_thickness_dir</span>, pattern <span class="op">=</span> <span class="st">".tif$"</span>, 
                       full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Filter the glacier thickness file list for the glacier ids in the catchment of </span>
<span class="co"># interest. </span>
<span class="va">filelist</span> <span class="op">&lt;-</span> <span class="va">filelist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">rgi</span><span class="op">$</span><span class="va">RGIId</span>, <span class="va">grep</span>, <span class="va">filelist</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Get the maximum glacier thickness for each of the glaciers in filelist. </span>
<span class="co"># Note: this works only for small catchments as the origin of the rasters to be </span>
<span class="co"># mosaiced needs to be consistent. For a larger data set you will need to implement </span>
<span class="co"># a loop over all glaciers to extract the thickness per glacier or per elevation </span>
<span class="co"># band. </span>
<span class="va">glacier_thickness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/mosaic.html">mosaic</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fun <span class="op">=</span> <span class="va">max</span><span class="op">)</span>,
                            <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">filelist</span>, <span class="fu">raster</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/raster/man/raster.html">raster</a></span><span class="op">)</span><span class="op">)</span>

<span class="co"># For plotting, clip the glacier thickness raster of the basin to the basin boundary</span>
<span class="va">glacier_thickness</span> <span class="op">&lt;-</span> <span class="fu">mask</span><span class="op">(</span><span class="va">glacier_thickness</span>, <span class="va">shp_koksu_shait_outline</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Glacier thickness by Farinotti et al., 2019" </span>
<span class="co">#| out.width = 90%</span>
<span class="va">glacier_thickness_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">as</span><span class="op">(</span><span class="va">glacier_thickness</span>, 
                                         <span class="st">"SpatialPixelsDataFrame"</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">glacier_thickness_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Thickness\n[m weq]"</span>, <span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>

<span class="co"># Filter for glacier thickness larger than 0</span>
<span class="va">glacier_thickness_df</span> <span class="op">&lt;-</span> <span class="va">glacier_thickness_df</span> |&gt; 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">`Thickness\n[m weq]`</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_tile</span><span class="op">(</span>data <span class="op">=</span> <span class="va">glacier_thickness_df</span>, 
            <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">`Thickness\n[m weq]`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">basin</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1180000</span>, <span class="fl">1196888</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4590000</span>, <span class="fl">4610000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 31942 rows containing missing values (geom_tile).</code></pre>
<p><img src="glaciers-01-intro_files/figure-html/thickness-1.png" width="700"></p>
</div>
</div>
<div id="glacier-thinning-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#glacier-thinning-rates" class="anchor"></a>Glacier thinning rates</h2>
<p><span class="citation">Hugonnet et al. (2021)</span> provide annual
estimates of glacier thinning rates for each glacier in the RGI v6.0
data set. It is advised to not use the annual data though but an average
over at least 5 years to get reliable thinning rates. We will refer to
this data set as the thinning rates data set or the Hugonnet data
set.</p>
<p>The glacier thinning rates can be downloaded from the <a href="https://www.sedoo.fr/theia-publication-products/?uuid=c428c5b9-df8f-4f86-9b75-e04c778e29b9">data
repository</a> as described in the <a href="https://github.com/rhugonnet/ww_tvol_study">github site</a> linked
under the code availability section of the <a href="https://www.nature.com/articles/s41586-021-03436-z">online
paper</a> of <span class="citation">Hugonnet et al. (2021)</span>. We
use the per-glacier time series.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Average glacier mass change by Hugonnet et al., 2021."</span>
<span class="co">#| out.width = 90%</span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">glaciers_hugonnet</span> |&gt; 
         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">==</span> <span class="fl">20</span>, <span class="va">start</span> <span class="op">==</span> <span class="st">"2000-01-01"</span><span class="op">)</span>
<span class="va">temp_coord</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="fu">st_coordinates</span><span class="op">(</span><span class="fu">st_centroid</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in st_centroid.sf(temp): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">dmdtda</span><span class="op">)</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"imbal. abl.\n[m we/a]"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1180000</span>, <span class="fl">1196888</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4590000</span>, <span class="fl">4610000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-01-intro_files/figure-html/thinning-1.png" width="700"></p>
</div>
<div id="glacier-discharge" class="section level2">
<h2 class="hasAnchor">
<a href="#glacier-discharge" class="anchor"></a>Glacier discharge</h2>
<p><span class="citation">Miles et al. (2021)</span> ran specific mass
balance calculations over the glaciers larger than 2 km2 of High
Mountain Asia. They provide the average glacier discharge between 2000
and 2016. We have derived an empirical relationship to derive glacier
discharge based on glacier thinning rates which is available in the
function . We will refer to this data set as the glacier discharge data
set or the Miles data set.</p>
<p>The data is available from the <a href="https://zenodo.org/record/5119153#.Yfjv6-rMKF4">data
repository</a> linked in the <a href="https://www.nature.com/articles/s41467-021-23073-4">online version
of the paper</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#| fig.cap = "Glacier discharge derived from Miles et al., 2021."</span>
<span class="co">#| out.width = 90%</span>
<span class="co"># Calculate glacier discharge using the glacierDischarge_HM function of the </span>
<span class="co"># riversCentralAsia package. An empirical relationship between glacier thinning </span>
<span class="co"># rates by Hugonnet et al., 2021 and glacier discharge by Miles et al., 2021.  </span>
<span class="va">glaciers_hugonnet</span> <span class="op">&lt;-</span> <span class="va">glaciers_hugonnet</span> |&gt; 
  <span class="fu">mutate</span><span class="op">(</span>Qgl_m3a <span class="op">=</span> <span class="fu"><a href="../reference/glacierDischarge_HM.html">glacierDischarge_HM</a></span><span class="op">(</span><span class="va">dhdt</span><span class="op">)</span><span class="op">)</span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">glaciers_hugonnet</span> |&gt; 
         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">==</span> <span class="fl">20</span>, <span class="va">start</span> <span class="op">==</span> <span class="st">"2000-01-01"</span><span class="op">)</span>
<span class="va">temp_coord</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="fu">st_coordinates</span><span class="op">(</span><span class="fu">st_centroid</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in st_centroid.sf(temp): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Qgl_m3a</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"Qgl\n[10^6 m3/a]"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1180000</span>, <span class="fl">1196888</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4590000</span>, <span class="fl">4610000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="glaciers-01-intro_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="a-note-on-the-uncertainties-of-glacier-data-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#a-note-on-the-uncertainties-of-glacier-data-sets" class="anchor"></a>A note on the uncertainties of glacier data sets</h2>
<p>The geometries of the RGI v6.0 data set are generally very good. If
you simulate glacier discharge in a small catchment with few glaciers it
is advisable to visually check the glacier geometries and make sure, all
relevant glaciers in the basin are included in the RGI data set. You may
have to manually add missing glaciers or correct the geometry.</p>
<p>For some regions in Central Asia, <a href="https://www.openstreetmap.org/#map=6/40.684/66.076">OpenStreetMap</a>
is an excellent reference for glacier locations and names in Central
Asia. You can import the map layer in QGIS or also download
individual.</p>
<p>The glacier thickness data set is validated only at few locations as
measurements of glacier thickness are typically not available.
Uncertainties of up to p/m 50% have to be taken into account according
to <span class="citation">Farinotti et al. (2019)</span>.</p>
<p><span class="citation">Hugonnet et al. (2021)</span> &amp; <span class="citation">Miles et al. (2021)</span> provide the uncertainties of
their estimates for per-glacier glacier thinning &amp; discharge rates
in the data set itself.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-farinotti_consensus_2019" class="csl-entry">
Farinotti, Daniel, Matthias Huss, Johannes J. Fürst, Johannes Landmann,
Horst Machguth, Fabien Maussion, and Ankur Pandit. 2019. <span>“A
Consensus Estimate for the Ice Thickness Distribution of All Glaciers on
<span>Earth</span>.”</span> <em>Nature Geoscience</em> 12 (3): 168–73.
<a href="https://doi.org/10.1038/s41561-019-0300-3">https://doi.org/10.1038/s41561-019-0300-3</a>.
</div>
<div id="ref-hugonnet_accelerated_2021" class="csl-entry">
Hugonnet, Romain, Robert McNabb, Etienne Berthier, Brian Menounos,
Christopher Nuth, Luc Girod, Daniel Farinotti, et al. 2021.
<span>“Accelerated Global Glacier Mass Loss in the Early Twenty-First
Century.”</span> <em>Nature</em> 592 (7856): 726–31. <a href="https://doi.org/10.1038/s41586-021-03436-z">https://doi.org/10.1038/s41586-021-03436-z</a>.
</div>
<div id="ref-huss_global-scale_2018" class="csl-entry">
Huss, Matthias, and Regine Hock. 2018. <span>“Global-Scale Hydrological
Response to Future Glacier Mass Loss.”</span> <em>Nature Climate
Change</em> 8 (2): 135–40. <a href="https://doi.org/10.1038/s41558-017-0049-x">https://doi.org/10.1038/s41558-017-0049-x</a>.
</div>
<div id="ref-miles_health_2021" class="csl-entry">
Miles, Evan, Michael McCarthy, Amaury Dehecq, Marin Kneib, Stefan
Fugger, and Francesca Pellicciotti. 2021. <span>“Health and
Sustainability of Glaciers in <span>High</span> <span>Mountain</span>
<span>Asia</span>.”</span> <em>Nature Communications</em> 12 (2868): 10.
https://doi.org/<a href="https://doi.org/10.1038/s41467-021-23073-4">https://doi.org/10.1038/s41467-021-23073-4</a>.
</div>
<div id="ref-rgi60" class="csl-entry">
RGI Consortium. 2017. <span>“<span>Randolph</span> <span>Glacier</span>
<span>Inventory</span> – a Dataset of Global Glacier Outlines: Version
6.0: Technical Report.”</span> <span>Global Land Ice Measurements from
Space, Colorado, USA. Digital Media</span>. https://doi.org/<a href="https://doi.org/10.7265/N5-RGI-60">https://doi.org/10.7265/N5-RGI-60</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tobias Siegfried, Beatrice Marti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
